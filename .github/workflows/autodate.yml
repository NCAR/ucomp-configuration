name: Commit date to master
on: push
jobs:
  date:
    runs-on: ubuntu-latest
    steps:
      # Checkout the branch
      - name: checkout
        uses: actions/checkout@v2-beta # use either @v2-beta or @master. Eventually there will be a @v2 tag.

      - name: save current date
        run: |
          script: |
            import os
            os.chdir("Recipes")
            
            def read_script(f,scriptname,tab=0,childextension=".rcp"):
              script = open(scriptname,"r")
              tab = tab +1
              for child in script.readlines():
                child=child.strip()
                if len(child) > 0 and child[0] != "#" and not child.startswith("DATE") and not child.startswith("AUTHOR") and not child.startswith("DESCRIPTION"):
                  f.write((f"{tab*6*'-'}>  {child.split('#')[0]}\n"))
                  try:
                    read_script(f,child,tab)
                  except:
                    pass
              script.close()
            f = open("daily.summary","w")
            f.write("daily.menu\n")
            read_script(f,"daily.menu",0,".cbk")
            f.close()

      - name: setup git config
        run: |
          # setup the username and email. I tend to use 'GitHub Actions Bot' with no email by default
          git config user.name "GitHub Actions Bot"
          git config user.email "<>"

      - name: commit
        run: |
          # Stage the file, commit and push
          git add time.txt
          git commit -m "new date commit"
          git push origin main
